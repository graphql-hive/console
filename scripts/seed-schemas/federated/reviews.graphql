extend schema
  @link(
    url: "https://specs.apollo.dev/federation/v2.3"
    import: ["@key", "@override", "@external", "@provides"]
  )

"""
Input for creating a new product review
"""
input CreateReviewInput {
  """
  Universal Product Code of the product being reviewed
  """
  productUpc: String!
  """
  ID of the user creating the review
  """
  userId: ID!
  """
  Rating score (e.g., 1-5 stars)
  """
  rating: Int!
  """
  Review text content
  """
  body: String
}

"""
Product review written by a user
"""
type Review @key(fields: "id") {
  """
  Unique identifier for the review
  """
  id: ID!
  """
  Review text content
  """
  body: String
  """
  User who wrote the review
  """
  author: User
  """
  Product being reviewed
  """
  product: Product
}

extend type User @key(fields: "id") {
  id: ID!
  reviews: [Review]
}

extend type Product @key(fields: "upc") {
  upc: String!
  reviews: [Review]
  reviewsCount: Int!
  reviewsScore: Float! @override(from: "products")
}

type Query {
  """
  Get a specific review by ID
  """
  review(id: Int!): Review
  """
  Get reviews filtered by product and rating range
  """
  reviews(productUpc: String, minRating: Int, maxRating: Int): [Review]
}

type Mutation {
  """
  Create a new product review
  """
  createReview(input: CreateReviewInput!): Review!
}
